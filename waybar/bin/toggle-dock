#!/bin/bash
# Toggle between docked (laptop screen disabled) and dual-monitor mode
# Also manages hypridle: disabled when docked, enabled when dual-monitor

current_profile=$(hyprmon -active-profile 2>/dev/null)

if [ "$current_profile" = "dual-monitor" ]; then
    # Switch to docked mode (laptop screen disabled)
    hyprmon -profile laptop-screen-disabled

    # Disable hypridle (no auto-lock when docked)
    if pgrep -x hypridle >/dev/null; then
        pkill -x hypridle
    fi

    notify-send "Docked Mode" "Laptop screen disabled • Auto-lock disabled"
else
    # Switch to dual-monitor mode
    hyprmon -profile dual-monitor

    # Enable hypridle (auto-lock when using both screens)
    if ! pgrep -x hypridle >/dev/null; then
        uwsm app -- hypridle >/dev/null 2>&1 &
    fi

    notify-send "Dual Monitor Mode" "Both screens enabled • Auto-lock enabled"
fi

# Refresh waybar dock status indicator
pkill -RTMIN+10 waybar 2>/dev/null
